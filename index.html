<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ideal BSA Calculator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 500px;
            width: 90%;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        /* Adjustments for smaller screens */
        @media screen and (max-width: 800px) {
            .container {
                max-width: 90%;
            }

        h1 {
            text-align: center;
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 8px;
        }

        input[type="number"],
        select {
            width: calc(100% - 10px);
            padding: 8px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        .result {
            margin-top: 20px;
            font-size: 16px;
        }

        .result span {
            font-weight: bold;
        }

        .message {
            color: #888;
            font-style: italic;
        }
    </style>
</head>
<body>
    <body>
        <div class="container">
        <h1>Ideal BSA Calculator</h1>
        <div>
            <label for="unit-system">Select Unit System:</label>
            <select id="unit-system">
                <option value="metric">Metric (cm, kg)</option>
                <option value="imperial">Imperial (in, lbs)</option>
            </select>
        </div>
        <div>
            <label for="height">Height (<span id="height-unit-label">cm</span>):</label>
            <input type="number" id="height" name="height" required>
        </div>
        <div>
            <label for="weight">Weight (<span id="weight-unit-label">kg</span>):</label>
            <input type="number" id="weight" name="weight" required>
        </div>
        <div>
            <label for="bsa-equation">Select BSA Equation:</label>
            <select id="bsa-equation">
                <option value="boyd">Boyd</option>
                <option value="dreyer">Dreyer (weight only)</option>
                <option value="dubois">DuBois</option>
                <option value="gehan">Gehan</option>
                <option value="haycock" selected="selected">Haycock</option>
                <option value="mosteller">Mosteller</option>

            </select>
        </div>

        <div>
            <button type="button" id="calculate">Calculate</button>
        </div>

    <div id="results" class="result">
        <h2 id="bsa"></h2>
        <h3 id="bmi"></h3>
        <p id="bmi-normal">This person has a BMI that is normal. There is no need to "idealize" BSA.</p>
        <p id="bmi-abnormal">This person has a BMI that is associated with being <span id="bmi-category"></span>. If this person had a BMI of 25, the weight would be <span id="wt-bmi25"></span>. Recalculating the BSA using this weight will give us the "ideal BSA." </p>
        <h2 id="ideal-bsa" class="ideal-bsa"></h2>
    </div>
    </div>

    <script>
$(document).ready(function() {
    //hide the results
    $('#bmi-normal, #bmi-abnormal, #ideal-bsa').hide();
    function calculate() {
        var height, weight, BMI, BSA, idealBSA, idealWeight, weightUnit;
        var bsaEquation = $('#bsa-equation').val();

        if ($('#unit-system').val() === 'metric') {
            height = parseFloat($('#height').val());
            weight = parseFloat($('#weight').val());
            weightUnit = 'kg';
        } else { // Convert imperial to metric
            height = parseFloat($('#height').val()) * 2.54; // inches to cm
            weight = parseFloat($('#weight').val()) * 0.453592; // lbs to kg
            weightUnit = 'lbs';
        }

        // Calculate BMI
        BMI = weight / ((height / 100) * (height / 100));
        $('#bmi').text('BMI: ' + BMI.toFixed(2));

        if (BMI < 25) {
            $('#ideal-bsa').text('BSA: '+bsaMosteller.toFixed(2) + ' cm² ');
            $('#wt-bmi25').text('Since the BMI is not greater than 25, the BSA is already "idealized"');
        } else {
            var wtBmi25 = (25 * ((height / 100) * (height / 100)));
            var idealBsa = Math.sqrt((height * wtBmi25) / 3600);

            // Displaying calculations
            $('#ideal-bsa').text('Ideal BSA: ' + idealBsa.toFixed(2) + ' m²');
            //make sure the wt-BMI25 is in correct units
            var displayCorrectedWt;
            if (weightUnit === 'lbs'){
                displayCorrectedWt = wtBmi25 * 2.205;
            } else {
                displayCorrectedWt = wtBmi25;
            }
            $('#wt-bmi25').text('the weight at this ideal BSA is: ' + displayCorrectedWt.toFixed(1) + ' '+ weightUnit  );
        }

    }

    function calcBSA(ht, wt, method){
        switch(method){ 
            case "dubois":
                return 0.007184 * Math.pow(ht, 0.725) * Math.pow(wt, 0.425);
            case "haycock":
                return 0.024265 * Math.pow(ht, 0.3964) * Math.pow(wt, 0.5378);
            case "gehan":
                return 0.0235 * Math.pow(ht, 0.42246) * Math.pow(wt, 0.51456);
            case "mosteller":
                return Math.sqrt((ht * wt) / 3600);
            case "boyd":
                wt = wt * 1000;
                var exponent = 0.7285 - 0.0188 * (Math.LOG10E * Math.log(wt)); //necessary to get the Log base 10 of (wt)
                return 0.0003207 * Math.pow(ht, 0.3) * Math.pow(wt, exponent);
            case "dreyer":
                return 0.1 * Math.pow(wt, (2 / 3));
            default:
                return 0.024265 * Math.pow(ht, 0.3964) * Math.pow(wt, 0.5378);// returns Haycock in the event an unfamiliar method is passed in        }
    }

    function isValidNumber(value) {
        return !isNaN(value) && value !== '';
    }
    
    $('#unit-system').change(function() {
        if ($(this).val() === 'metric') {
            $('#height-unit-label').text('cm');
            $('#weight-unit-label').text('kg');

            // Convert values to metric units
            $('#height').val(parseFloat($('#height').val()) * 2.54);
            $('#weight').val(parseFloat($('#weight').val()) * 0.453592);
        } else {
            $('#height-unit-label').text('in');
            $('#weight-unit-label').text('lbs');

            // Convert values to imperial units
            $('#height').val(parseFloat($('#height').val()) / 2.54);
            $('#weight').val(parseFloat($('#weight').val()) / 0.453592);
        }
    });    
    $('#height, #weight, #bsaEquation').on('input', function() {
        if (isValidNumber($('#height').val()) && isValidNumber($('#weight').val())) {
            calculate();
        } else {
            // Clear results if inputs are invalid
            $('#bsa-haycock, #bsa-mosteller, #bsa-dubois, #bmi, #ideal-bsa', '#wt-bmi25').text('');
            $('.ideal-bsa').hide();
        }
    });
        $('#calculate').click(function() {
        calculate();
    });
});
        
    </script>
</body>
</html>
